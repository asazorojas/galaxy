
<!DOCTYPE html>
<html lang="en">
    
    <head>
        <meta charset="utf-8">
        <title>Configuring and Monitoring the Comm Component | Galaxy</title>
        <link rel="stylesheet" href="../../_static/pygments.css" type="text/css"/>
        <link rel="stylesheet" href="../../_static/pudoc.css" type="text/css"/>
        <link rel="top" title="Galaxy" href="../../index.html"/>
        <link rel="up" title="Configuring and Monitoring Galaxy" href="config.html"/>
        <link rel="next" title="Configuring, Running and Monitoring the Server" href="config-server.html"/>
        <link rel="prev" title="Configuring and Monitoring the Messenger" href="config-messenger.html"/>
        <style lang="text/css">
            #top-bar, #top-bar small, #top-bar a {
                text-shadow: 0px -1px 0px #EAEAEA;
            color: #000;
            }

            #top-bar {
                background-color: #444;
            background-image: -moz-linear-gradient(top, #FAFAFA, #EAEAEA);
            background-image: -ms-linear-gradient(top, #FAFAFA, #EAEAEA);
            background-image: -webkit-gradient(linear, 0 0, 0 100%, from(#FAFAFA), to(#EAEAEA));
            background-image: -webkit-linear-gradient(top, #FAFAFA, #EAEAEA);
            background-image: -o-linear-gradient(top, #FAFAFA, #EAEAEA);
            background-image: linear-gradient(top, #FAFAFA, #EAEAEA);
            filter: progid:DXImageTransform.Microsoft.gradient(startColorstr = '#FAFAFA', endColorstr = '#EAEAEA', GradientType = 0);
            -webkit-border-radius: 0;
            -moz-border-radius: 0;
            border-radius: 0;
            border-bottom: 1px solid #CACACA;
            box-shadow: 0 1px 0 rgba(255, 255, 255, 0.4),0 0 10px rgba(0, 0, 0, 0.1);
            }


            .hero-unit {
                background-image: url("../../_static/xxx.png") !important;
                background-repeat: no-repeat !important;
                background-position: 30px 50px;
            }

            .hero-unit div.section {
                padding-left: 200px !important;
            }
        </style>
    </head>
    <body>
        <a href="https://github.com/puniverse/galaxy">
            <img style="position: absolute; top: 0; right: 0; border: 0;"
                 src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"
                 alt="Fork me on GitHub"></a>
        <div class="navbar">
            <div class="navbar-inner container-fluid" id="top-bar">
                <header class="row-fluid">
                    <h1 class="span12" id="title">
                        <a href="../../index.html">Galaxy</a>
                        <small>a high-performance in-memory data grid</small>
                    </h1>
                </header>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span3" id="sidebar">
                    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../news.html">News</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About Galaxy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../start/getting-started.html">Getting Started With Galaxy</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../intro.html">Introduction to Galaxy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/api.html">Galaxy&#8217;s API</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="config.html">Configuring and Monitoring Galaxy</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="config.html#the-configuration-file-s">The configuration file(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="config.html#configuring-galaxy-monitoring">Configuring Galaxy monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="config.html#monitoring-galaxy-s-components">Monitoring Galaxy&#8217;s components</a></li>
<li class="toctree-l3"><a class="reference internal" href="config.html#logging">Logging</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="config.html#galaxy-s-components">Galaxy&#8217;s components</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="config-spring.html">A Spring Primer</a></li>
<li class="toctree-l4"><a class="reference internal" href="config-cluster.html">Configuring the Cluster Component</a></li>
<li class="toctree-l4"><a class="reference internal" href="config-cache.html">Configuring and Monitoring the Cache</a></li>
<li class="toctree-l4"><a class="reference internal" href="config-messenger.html">Configuring and Monitoring the Messenger</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="">Configuring and Monitoring the Comm Component</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#common-comm-configurations">Common comm configurations</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#timeout">Timeout</a></li>
<li class="toctree-l6"><a class="reference internal" href="#no-multicast-using-galaxy-in-the-cloud">No multicast (using Galaxy in the cloud)</a></li>
<li class="toctree-l6"><a class="reference internal" href="#the-servercomm">The ServerComm</a></li>
<li class="toctree-l6"><a class="reference internal" href="#the-slavecomm">The SlaveComm</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#using-the-udp-comm">Using the UDP comm</a></li>
<li class="toctree-l5"><a class="reference internal" href="#configuring-netty-channels">Configuring Netty Channels</a></li>
<li class="toctree-l5"><a class="reference internal" href="#using-the-jgroups-comm">Using the JGroups comm</a></li>
<li class="toctree-l5"><a class="reference internal" href="#monitoring-the-comm-component">Monitoring the <tt class="docutils literal"><span class="pre">comm</span></tt> component</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="config-server.html">Configuring, Running and Monitoring the Server</a></li>
<li class="toctree-l4"><a class="reference internal" href="config-misc.html">Miscellaneous Configurations</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

                    <hr/>
                    <ul>
                        <li><a href="http://puniverse.github.com/galaxy/javadoc/index.html">Javadocs</a></li>
                        <li><a href="https://github.com/puniverse/galaxy/downloads">Download</a></li>
                        <li><a href="https://groups.google.com/forum/#!forum/galaxy-user">Mailing List</a></li>
                        <li><a href="https://github.com/puniverse/galaxy/issues/">Issue Tracker</a></li>
                        <li><a href="http://blog.paralleluniverse.co">Blog</a></li>
                    </ul>
                </div>
                <div class="span9" id="body">
                     
  <div class="section" id="configuring-and-monitoring-the-comm-component">
<span id="man-config-comm"></span><h1>Configuring and Monitoring the Comm Component<a class="headerlink" href="#configuring-and-monitoring-the-comm-component" title="Permalink to this headline">¶</a></h1>
<p>The Comm component (bean id: <tt class="docutils literal"><span class="pre">comm</span></tt>) is responsible for transmitting Galaxy&#8217;s internal cache-coherence protocol messages, as well as user messages
(sent with the <cite>Messenger</cite>) over the network. There are currently two implementations for this component. The first uses UDP, and the second uses
JGroups and is available only if the cluster is configured to use JGroups (see <a class="reference internal" href="config-cluster.html#man-config-cluster-jgroups"><em>Using JGroups</em></a>).</p>
<div class="section" id="common-comm-configurations">
<span id="man-config-comm-common"></span><h2>Common comm configurations<a class="headerlink" href="#common-comm-configurations" title="Permalink to this headline">¶</a></h2>
<p>Both <tt class="docutils literal"><span class="pre">comm</span></tt> implementations share a couple of very important configuration properties.</p>
<div class="section" id="timeout">
<span id="man-config-comm-common-timeout"></span><h3>Timeout<a class="headerlink" href="#timeout" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">timeout</span></tt> configuration (property, <tt class="docutils literal"><span class="pre">long</span></tt>, default: <tt class="docutils literal"><span class="pre">200</span></tt>), is the duration, <strong>in milliseconds</strong> to wait for a response to a
massage. This, in effect, determines the time it takes for any grid operation to fail and throw a <tt class="docutils literal"><span class="pre">TimeoutException</span></tt> (See <a class="reference internal" href="../api/api-store.html#man-api-store-ownership-deadlock"><em>Deadlocks</em></a>
and <a class="reference internal" href="../api/api-store.html#man-api-store-transactions"><em>Transactions</em></a>).</p>
<p>The shorter the timeout is, the faster deadlocks will be detected, but so will more operations fail spuriously due to network latency.</p>
</div>
<div class="section" id="no-multicast-using-galaxy-in-the-cloud">
<span id="man-config-comm-common-cloud"></span><h3>No multicast (using Galaxy in the cloud)<a class="headerlink" href="#no-multicast-using-galaxy-in-the-cloud" title="Permalink to this headline">¶</a></h3>
<p>For some internal operations (such as finding the owner of a freshly-encountered item id), both Comm implementations use multicast by default.
Some cloud platforms (like Amazon EC2) do not allow multicast, so to run Galaxy without multicast, we can configure it to use the server for
node discovery. Of course, in a situation like that a server is necessary.</p>
<p>In deployments where multicast is available, communicating with the server instead of multicasting can have a performance impact - sometimes for the better
and sometimes for the worse, depending mostly on your server&#8217;s performance.</p>
<p>To tell <tt class="docutils literal"><span class="pre">comm</span></tt> to talk to the server instead of multicasting, set the bean property <tt class="docutils literal"><span class="pre">sendToServerInsteadOfMulticast</span></tt> to <tt class="docutils literal"><span class="pre">true</span></tt> (it&#8217;s <tt class="docutils literal"><span class="pre">false</span></tt> by default).</p>
<p>Please not that if you&#8217;re using JGroups for your <tt class="docutils literal"><span class="pre">cluster</span></tt> component implementation, you must configure JGroups to avoid multicast as well.
See <a class="reference internal" href="config-cluster.html#man-config-cluster-jgroups-cloud"><em>Using JGroups in the Cloud</em></a> for more information.</p>
</div>
<div class="section" id="the-servercomm">
<span id="man-config-comm-common-servercomm"></span><h3>The ServerComm<a class="headerlink" href="#the-servercomm" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">comm</span></tt> makes use of another component, called <tt class="docutils literal"><span class="pre">serverComm</span></tt> to communicate with the server. At the moment, there is just one implementation of <tt class="docutils literal"><span class="pre">server-comm</span></tt>,
which uses TCP (so it makes use of the optional <tt class="docutils literal"><span class="pre">bossExecutor</span></tt>, <tt class="docutils literal"><span class="pre">workerExecutor</span></tt> and <tt class="docutils literal"><span class="pre">receiveExecutor</span></tt> properties,
explained in <a class="reference internal" href="#man-config-comm-netty"><em>Configuring Netty Channels</em></a>.).</p>
<p>So, if your cluster has a server node, define it with the following bean (in this example we do not set the thread-pool properties, so defaults are used):</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;serverComm&quot;</span> <span class="na">class=</span><span class="s">&quot;co.paralleluniverse.galaxy.netty.TcpServerClientComm&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<p>and link it to the <tt class="docutils literal"><span class="pre">comm</span></tt> bean by putting this line in the <tt class="docutils literal"><span class="pre">comm</span></tt> bean definition:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;constructor-arg</span> <span class="na">name=</span><span class="s">&quot;serverComm&quot;</span> <span class="na">ref=</span><span class="s">&quot;serverComm&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<p>(actually, there is one more <tt class="docutils literal"><span class="pre">server-comm</span></tt> implementation, one that&#8217;s used with something called &#8220;dumb servers&#8221;. See <a class="reference internal" href="config-server.html#man-config-server-dumb"><em>Dumb servers</em></a> for details).</p>
<p>If your cluster is configured without a server, set this constructor-arg to <tt class="docutils literal"><span class="pre">null</span></tt> (see <a class="reference internal" href="config-spring.html#man-config-spring-values-null"><em>Null values</em></a>).</p>
</div>
<div class="section" id="the-slavecomm">
<span id="man-config-comm-common-slavecomm"></span><h3>The SlaveComm<a class="headerlink" href="#the-slavecomm" title="Permalink to this headline">¶</a></h3>
<p>Just like a special component is used to communicate with the server, so too a special component is used to communicate with the slaves in the node&#8217;s backup group.
The component is <tt class="docutils literal"><span class="pre">slaveComm</span></tt>, and it currently has one implementation that uses TCP called <tt class="docutils literal"><span class="pre">co.paralleluniverse.galaxy.netty.TcpSlaveComm</span></tt>.</p>
<p>In addition to the optional <tt class="docutils literal"><span class="pre">bossExecutor</span></tt>, <tt class="docutils literal"><span class="pre">workerExecutor</span></tt> and <tt class="docutils literal"><span class="pre">receiveExecutor</span></tt> properties explained in <a class="reference internal" href="#man-config-comm-netty"><em>Configuring Netty Channels</em></a>,
it has one configuration property:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">port</span></tt> (constructor-arg, <tt class="docutils literal"><span class="pre">int</span></tt>)</dt>
<dd>The TCP port used for master-slave communications. The master binds a server socket to this port (and the slaves discover the port using the distributed
configuration record, so in principle, this port can be different on each node, as it&#8217;s used only when the node is master.)</dd>
</dl>
<p>Here&#8217;s an example:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;slaveComm&quot;</span> <span class="na">class=</span><span class="s">&quot;co.paralleluniverse.galaxy.netty.TcpSlaveComm&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;constructor-arg</span> <span class="na">name=</span><span class="s">&quot;port&quot;</span> <span class="na">value=</span><span class="s">&quot;${grid.slave_port}&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;receiveExecutor&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;org.jboss.netty.handler.execution.OrderedMemoryAwareThreadPoolExecutor&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">&quot;0&quot;</span> <span class="na">value=</span><span class="s">&quot;8&quot;</span><span class="nt">/&gt;</span> <span class="c">&lt;!-- name=&quot;corePoolSize&quot; --&gt;</span>
                <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">&quot;1&quot;</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span> <span class="c">&lt;!-- name=&quot;maxChannelMemorySize&quot; --&gt;</span>
                <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">&quot;2&quot;</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span> <span class="c">&lt;!-- name=&quot;maxTotalMemorySize&quot; --&gt;</span>
                <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">&quot;3&quot;</span> <span class="na">value=</span><span class="s">&quot;5000&quot;</span><span class="nt">/&gt;</span> <span class="c">&lt;!-- name=&quot;keepAliveTime&quot; --&gt;</span>
                <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">&quot;4&quot;</span> <span class="na">value=</span><span class="s">&quot;MILLISECONDS&quot;</span><span class="nt">/&gt;</span> <span class="c">&lt;!-- name=&quot;unit&quot; --&gt;</span>
            <span class="nt">&lt;/bean&gt;</span>
        <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="using-the-udp-comm">
<span id="man-config-comm-udp"></span><h2>Using the UDP comm<a class="headerlink" href="#using-the-udp-comm" title="Permalink to this headline">¶</a></h2>
<p>The UDP implementation of the Comm component uses UDP datagrams for cache-coherence and user messages.</p>
<p>Other than the mentioned common ones, plus the <tt class="docutils literal"><span class="pre">bossExecutor</span></tt>, <tt class="docutils literal"><span class="pre">workerExecutor</span></tt> and <tt class="docutils literal"><span class="pre">receiveExecutor</span></tt> properties
explained in <a class="reference internal" href="#man-config-comm-netty"><em>Configuring Netty Channels</em></a>,
this implementation has the following configuration properties:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">port</span></tt> (constructor-arg, <tt class="docutils literal"><span class="pre">int</span></tt>)</dt>
<dd>The UDP port the component will send and receive messages on. This value <strong>does not</strong> have to be the same for all nodes.
(nodes know each other ports by publishing them as a configuration record in the cluster).</dd>
<dt><tt class="docutils literal"><span class="pre">multicastGroup</span></tt> (property, <tt class="docutils literal"><span class="pre">java.net.InetSocketAddress</span></tt>, required if <tt class="docutils literal"><span class="pre">sendToServerInsteadOfMulticast</span></tt> is <tt class="docutils literal"><span class="pre">true</span></tt>)</dt>
<dd>The multicast IP address this node will join for multicast address, and the port to use for sending and receiving multicast
messages. This value <strong>must be the same</strong> in all nodes. See the example below on how to set this property&#8217;s value.</dd>
<dt><tt class="docutils literal"><span class="pre">multicastNetworkInterface</span></tt> (property, <tt class="docutils literal"><span class="pre">java.net.NetworkInterface</span></tt>, default: <tt class="docutils literal"><span class="pre">null</span></tt>)</dt>
<dd>The network interface to use for multicast. If set to <tt class="docutils literal"><span class="pre">null</span></tt> (the default), the default interface will be used.</dd>
<dt><tt class="docutils literal"><span class="pre">receiveBufferSize</span></tt> (property, <tt class="docutils literal"><span class="pre">int</span></tt>, default: determined by the socket; implementation specific)</dt>
<dd>The size of the socket receive buffer (SO_RCVBUF). The SO_RCVBUF option is used by the the network implementation as a hint to size the
underlying network I/O buffers. The SO_RCVBUF setting may also be used by the network implementation to determine the maximum size
of the packet that can be received on this socket.</dd>
<dt><tt class="docutils literal"><span class="pre">minimumNodesToMulticast</span></tt> (property, <tt class="docutils literal"><span class="pre">int</span></tt>, default: <tt class="docutils literal"><span class="pre">3</span></tt>)</dt>
<dd>The minimum number of nodes in the cluster (not including servers) for this component to use multicast. If there are fewer
online nodes than this value, the component will unicast messages to each node.</dd>
<dt><tt class="docutils literal"><span class="pre">resendPeriodMillisecs</span></tt> (property, <tt class="docutils literal"><span class="pre">int</span></tt>, default: <tt class="docutils literal"><span class="pre">20</span></tt>)</dt>
<dd>The duration in milliseconds to wait between consecutive resending of a message if a reply has not been received.
If <tt class="docutils literal"><span class="pre">exponentioalBackoff</span></tt> is turned on (it&#8217;s turned on by default), this is the initial duration (between the first time the
message is sent and the second).</dd>
<dt><tt class="docutils literal"><span class="pre">exponentialBackoff</span></tt> (property, <tt class="docutils literal"><span class="pre">boolean</span></tt>, default: <tt class="docutils literal"><span class="pre">true</span></tt>)</dt>
<dd>If turned on (which is the default), doubles the duration between resending of messages after each re-send.</dd>
<dt><tt class="docutils literal"><span class="pre">jitter</span></tt> (property, <tt class="docutils literal"><span class="pre">boolean</span></tt>, default: <tt class="docutils literal"><span class="pre">false</span></tt>)</dt>
<dd>If turned on, adds a random small jitter to the duration between resends.</dd>
<dt><tt class="docutils literal"><span class="pre">minDelayMicrosecs</span></tt> (property, <tt class="docutils literal"><span class="pre">int</span></tt>, default: <tt class="docutils literal"><span class="pre">1</span></tt>)</dt>
<dd>The minimum duration, in microseconds, to wait before transmitting a packet, for other messages to be sent so that they could be
added to the same packet.</dd>
<dt><tt class="docutils literal"><span class="pre">maxDelayMicrosecs</span></tt> (property, <tt class="docutils literal"><span class="pre">int</span></tt>, default: <tt class="docutils literal"><span class="pre">10</span></tt>)</dt>
<dd>The maximum duration, in microseconds, to wait for additional messages (in case they keep arriving), before transmitting a packet.</dd>
<dt><tt class="docutils literal"><span class="pre">maxQueueSize</span></tt> (property, <tt class="docutils literal"><span class="pre">int</span></tt>, default: 50)</dt>
<dd>The maximum number of messages waiting in the <tt class="docutils literal"><span class="pre">comm</span></tt> component&#8217;s message queue. If this number is reached, sending an additional
message will block until the queue length falls beneath it.</dd>
<dt><tt class="docutils literal"><span class="pre">maxPacketSize</span></tt> (property, <tt class="docutils literal"><span class="pre">int</span></tt>, default: <tt class="docutils literal"><span class="pre">4096</span></tt>)</dt>
<dd>The maximum size of a single packet the <tt class="docutils literal"><span class="pre">comm</span></tt> component will transmit. Data-item size (defined by the <tt class="docutils literal"><span class="pre">maxItemSize</span></tt> property of the <tt class="docutils literal"><span class="pre">cache</span></tt>
component; see <a class="reference internal" href="config-cache.html#man-config-cache-1"><em>Configuring the cache</em></a>) must not exceed this value (and there must also be some room left for headers).</dd>
<dt><tt class="docutils literal"><span class="pre">maxRequestOnlyPacketSize</span></tt> (property, <tt class="docutils literal"><span class="pre">int</span></tt>, default: <tt class="docutils literal"><span class="pre">maxPacketSize</span> <span class="pre">/</span> <span class="pre">2</span></tt>)</dt>
<dd>The maximum size of a packet that contains only request messages. Must be less than <tt class="docutils literal"><span class="pre">maxPacketSize</span></tt>.
The exact semantics of this property is beyond the scope of this document, but if this value is too close to <tt class="docutils literal"><span class="pre">maxPacketSize</span></tt> a deadlock condition
may arise (it will be clearly noted in the logs, so you can recognize it if it happens), and if it&#8217;s too small, performance under heavy load may suffer.</dd>
</dl>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;comm&quot;</span> <span class="na">class=</span><span class="s">&quot;co.paralleluniverse.galaxy.netty.UDPComm&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;constructor-arg</span> <span class="na">name=</span><span class="s">&quot;serverComm&quot;</span> <span class="na">ref=</span><span class="s">&quot;serverComm&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;timeout&quot;</span> <span class="na">value=</span><span class="s">&quot;500&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;sendToServerInsteadOfMulticast&quot;</span> <span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;constructor-arg</span> <span class="na">name=</span><span class="s">&quot;port&quot;</span> <span class="na">value=</span><span class="s">&quot;${grid.port}&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;minimumNodesToMulticast&quot;</span> <span class="na">value=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;multicastGroup&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;java.net.InetSocketAddress&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">&quot;0&quot;</span> <span class="na">value=</span><span class="s">&quot;225.0.0.1&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">&quot;1&quot;</span> <span class="na">value=</span><span class="s">&quot;7050&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/bean&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;resendPeriodMillisecs&quot;</span> <span class="na">value=</span><span class="s">&quot;35&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;exponentialBackoff&quot;</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;jitter&quot;</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;minDelayMicrosecs&quot;</span> <span class="na">value=</span><span class="s">&quot;500&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;maxDelayMicrosecs&quot;</span> <span class="na">value=</span><span class="s">&quot;2000&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;maxQueueSize&quot;</span> <span class="na">value=</span><span class="s">&quot;10&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;maxPacketSize&quot;</span> <span class="na">value=</span><span class="s">&quot;2048&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;maxRequestOnlyPacketSize&quot;</span> <span class="na">value=</span><span class="s">&quot;400&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;workerExecutor&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;co.paralleluniverse.galaxy.core.ConfigurableThreadPool&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;constructor-arg</span> <span class="na">name=</span><span class="s">&quot;corePoolSize&quot;</span> <span class="na">value=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;constructor-arg</span> <span class="na">name=</span><span class="s">&quot;maximumPoolSize&quot;</span> <span class="na">value=</span><span class="s">&quot;8&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;constructor-arg</span> <span class="na">name=</span><span class="s">&quot;keepAliveMillis&quot;</span> <span class="na">value=</span><span class="s">&quot;5000&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;constructor-arg</span> <span class="na">name=</span><span class="s">&quot;maxQueueSize&quot;</span> <span class="na">value=</span><span class="s">&quot;500&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/bean&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;receiveExecutor&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;org.jboss.netty.handler.execution.OrderedMemoryAwareThreadPoolExecutor&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">&quot;0&quot;</span> <span class="na">value=</span><span class="s">&quot;8&quot;</span><span class="nt">/&gt;</span> <span class="c">&lt;!-- name=&quot;corePoolSize&quot; --&gt;</span>
            <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">&quot;1&quot;</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span> <span class="c">&lt;!-- name=&quot;maxChannelMemorySize&quot; --&gt;</span>
            <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">&quot;2&quot;</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span> <span class="c">&lt;!-- name=&quot;maxTotalMemorySize&quot; --&gt;</span>
            <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">&quot;3&quot;</span> <span class="na">value=</span><span class="s">&quot;5000&quot;</span><span class="nt">/&gt;</span> <span class="c">&lt;!-- name=&quot;keepAliveTime&quot; --&gt;</span>
            <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">&quot;4&quot;</span> <span class="na">value=</span><span class="s">&quot;MILLISECONDS&quot;</span><span class="nt">/&gt;</span> <span class="c">&lt;!-- name=&quot;unit&quot; --&gt;</span>
        <span class="nt">&lt;/bean&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="configuring-netty-channels">
<span id="man-config-comm-netty"></span><h2>Configuring Netty Channels<a class="headerlink" href="#configuring-netty-channels" title="Permalink to this headline">¶</a></h2>
<p>Except for configuration messages used by the <tt class="docutils literal"><span class="pre">cluster</span></tt> component, all Galaxy network communication - peer-nodes to peer-nodes, peer-nodes to servers
and slaves to masters - uses the <a class="reference external" href="http://netty.io/">Netty</a> library (unless you&#8217;ve decided to use JGroups for peer-to-peer communication - see <a class="reference internal" href="#man-config-comm-jgroups"><em>Using the JGroups comm</em></a>).</p>
<p>Netty communication channels use various thread-pools.
TCP channels use a single &#8220;boss thread&#8221; taken from a &#8220;boss&#8221; thread-pool for making or accepting connections, and possibly multiple &#8220;worker&#8221; threads
taken from a different pool, responsible for sending and receiving messages. UDP channels (they&#8217;re connectionless) only use worker threads.</p>
<p>Components using TCP, therefore have two properties, <tt class="docutils literal"><span class="pre">bossExecutor</span></tt> and <tt class="docutils literal"><span class="pre">workerExecutor</span></tt> taking an instance of
<tt class="docutils literal"><span class="pre">java.util.concurrent.ThreadPoolExecutor</span></tt>. If you don&#8217;t set these properties, each uses a default thread-pool (returned from calling
<tt class="docutils literal"><span class="pre">java.util.concurrent.Executors.newCachedThreadPool()</span></tt>). Components making use of UDP don&#8217;t have the <tt class="docutils literal"><span class="pre">bossThread</span></tt> property.</p>
<p>See <a class="reference internal" href="config-misc.html#man-config-misc-threadpool-config"><em>Configuring a thread-pool</em></a> for the thread-pool configuration details.</p>
<p>In addition, all components using Netty can optionally use another thread-pool, passed to the <tt class="docutils literal"><span class="pre">receiveExecutor</span></tt> property. This thread-pool, which
must be an instance of <tt class="docutils literal"><span class="pre">org.jboss.netty.handler.execution.OrderedMemoryAwareThreadPoolExecutor</span></tt> (a subclass of <tt class="docutils literal"><span class="pre">java.util.concurrent.ThreadPoolExecutor</span></tt>),
and it is used to actually process the receive messages. If you set this property to <tt class="docutils literal"><span class="pre">null</span></tt> (which is the default), all message processing will
be done on the channel&#8217;s worker thread-pool.</p>
<p><tt class="docutils literal"><span class="pre">OrderedMemoryAwareThreadPoolExecutor</span></tt> doesn&#8217;t take a <tt class="docutils literal"><span class="pre">maximumPoolSize</span></tt> argument (as its core-size is also its maximum size), but
it does take two additional arguments:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">maxChannelMemorySize</span></tt> (<tt class="docutils literal"><span class="pre">long</span></tt>)</dt>
<dd>The maximum total size, in bytes, of the queued events per channel (i.e. per cluster node we&#8217;re communicating with).
A value of <tt class="docutils literal"><span class="pre">0</span></tt> disables this limit.</dd>
<dt><tt class="docutils literal"><span class="pre">maxTotalMemorySize</span></tt> (<tt class="docutils literal"><span class="pre">long</span></tt>)</dt>
<dd>The maximum total size, in bytes, of the queued events for this pool.
A value of <tt class="docutils literal"><span class="pre">0</span></tt> disables this limit.</dd>
</dl>
<p>Unfortunately, named constructor-args don&#8217;t seem to work with this class, so we must use argument indexes, and create the instance like so:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;org.jboss.netty.handler.execution.OrderedMemoryAwareThreadPoolExecutor&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">&quot;0&quot;</span> <span class="na">value=</span><span class="s">&quot;8&quot;</span><span class="nt">/&gt;</span> <span class="c">&lt;!-- &quot;corePoolSize&quot; --&gt;</span>
    <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">&quot;1&quot;</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span> <span class="c">&lt;!-- &quot;maxChannelMemorySize&quot; --&gt;</span>
    <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">&quot;2&quot;</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span> <span class="c">&lt;!-- &quot;maxTotalMemorySize&quot; --&gt;</span>
    <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">&quot;3&quot;</span> <span class="na">value=</span><span class="s">&quot;5000&quot;</span><span class="nt">/&gt;</span> <span class="c">&lt;!-- &quot;keepAliveTime&quot; --&gt;</span>
    <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">&quot;4&quot;</span> <span class="na">value=</span><span class="s">&quot;MILLISECONDS&quot;</span><span class="nt">/&gt;</span> <span class="c">&lt;!-- &quot;unit&quot; --&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="using-the-jgroups-comm">
<span id="man-config-comm-jgroups"></span><h2>Using the JGroups comm<a class="headerlink" href="#using-the-jgroups-comm" title="Permalink to this headline">¶</a></h2>
<p>The JGroups <tt class="docutils literal"><span class="pre">comm</span></tt> implementation is <tt class="docutils literal"><span class="pre">co.paralleluniverse.galaxy.jgroups.JGroupsComm</span></tt>.
It is only available when JGroups is chosen as the <tt class="docutils literal"><span class="pre">cluster</span></tt> component implementation (see <a class="reference internal" href="config-cluster.html#man-config-cluster-jgroups"><em>Using JGroups</em></a>).
Because JGroups is configured in the <tt class="docutils literal"><span class="pre">cluster</span></tt> bean, this bean has no properties other than the common <tt class="docutils literal"><span class="pre">comm</span></tt> ones, and can be defined
as simply as:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;comm&quot;</span> <span class="na">class=</span><span class="s">&quot;co.paralleluniverse.galaxy.jgroups.JGroupsComm&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;constructor-arg</span> <span class="na">name=</span><span class="s">&quot;serverComm&quot;</span> <span class="na">ref=</span><span class="s">&quot;serverComm&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;sendToServerInsteadOfMulticast&quot;</span> <span class="na">value=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;timeout&quot;</span> <span class="na">value=</span><span class="s">&quot;200&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">timeout</span></tt> and <tt class="docutils literal"><span class="pre">sendToServerInsteadOfMulticast</span></tt> properties are kept at their default values in this example, so they can be dropped entirely.</p>
</div>
<div class="section" id="monitoring-the-comm-component">
<span id="man-config-comm-monitoring"></span><h2>Monitoring the <tt class="docutils literal"><span class="pre">comm</span></tt> component<a class="headerlink" href="#monitoring-the-comm-component" title="Permalink to this headline">¶</a></h2>
<p>TBD</p>
</div>
</div>


                </div>
            </div>
            <hr/>
            <footer>
                &copy; Copyright 2012, Parallel Universe Software Co..
                Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>
                1.1.3.
            </footer>
        </div>
    </body>
</html>


