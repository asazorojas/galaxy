
<!DOCTYPE html>
<html lang="en">
    
    <head>
        <meta charset="utf-8">
        <title>Configuring the Cluster Component | Galaxy</title>
        <link rel="stylesheet" href="../../_static/pygments.css" type="text/css"/>
        <link rel="stylesheet" href="../../_static/pudoc.css" type="text/css"/>
        <link rel="top" title="Galaxy" href="../../index.html"/>
        <link rel="up" title="Configuring and Monitoring Galaxy" href="config.html"/>
        <link rel="next" title="Configuring and Monitoring the Cache" href="config-cache.html"/>
        <link rel="prev" title="A Spring Primer" href="config-spring.html"/>
        <style lang="text/css">
            #top-bar, #top-bar small, #top-bar a {
                text-shadow: 0px -1px 0px #EAEAEA;
            color: #000;
            }

            #top-bar {
                background-color: #444;
            background-image: -moz-linear-gradient(top, #FAFAFA, #EAEAEA);
            background-image: -ms-linear-gradient(top, #FAFAFA, #EAEAEA);
            background-image: -webkit-gradient(linear, 0 0, 0 100%, from(#FAFAFA), to(#EAEAEA));
            background-image: -webkit-linear-gradient(top, #FAFAFA, #EAEAEA);
            background-image: -o-linear-gradient(top, #FAFAFA, #EAEAEA);
            background-image: linear-gradient(top, #FAFAFA, #EAEAEA);
            filter: progid:DXImageTransform.Microsoft.gradient(startColorstr = '#FAFAFA', endColorstr = '#EAEAEA', GradientType = 0);
            -webkit-border-radius: 0;
            -moz-border-radius: 0;
            border-radius: 0;
            border-bottom: 1px solid #CACACA;
            box-shadow: 0 1px 0 rgba(255, 255, 255, 0.4),0 0 10px rgba(0, 0, 0, 0.1);
            }


            .hero-unit {
                background-image: url("../../_static/xxx.png") !important;
                background-repeat: no-repeat !important;
                background-position: 30px 50px;
            }

            .hero-unit div.section {
                padding-left: 200px !important;
            }
        </style>
    </head>
    <body>
        <a href="https://github.com/puniverse/galaxy">
            <img style="position: absolute; top: 0; right: 0; border: 0;"
                 src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"
                 alt="Fork me on GitHub"></a>
        <div class="navbar">
            <div class="navbar-inner container-fluid" id="top-bar">
                <header class="row-fluid">
                    <h1 class="span12" id="title">
                        <a href="../../index.html">Galaxy</a>
                        <small>a high-performance in-memory data grid</small>
                    </h1>
                </header>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span3" id="sidebar">
                    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../news.html">News</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About Galaxy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../start/getting-started.html">Getting Started With Galaxy</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../intro.html">Introduction to Galaxy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/api.html">Galaxy&#8217;s API</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="config.html">Configuring and Monitoring Galaxy</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="config.html#the-configuration-file-s">The configuration file(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="config.html#configuring-galaxy-monitoring">Configuring Galaxy monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="config.html#monitoring-galaxy-s-components">Monitoring Galaxy&#8217;s components</a></li>
<li class="toctree-l3"><a class="reference internal" href="config.html#logging">Logging</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="config.html#galaxy-s-components">Galaxy&#8217;s components</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="config-spring.html">A Spring Primer</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="">Configuring the Cluster Component</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#servers-and-backup-groups">Servers and Backup Groups</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#server-node">Server node</a></li>
<li class="toctree-l6"><a class="reference internal" href="#backup-groups">Backup Groups</a></li>
<li class="toctree-l6"><a class="reference internal" href="#should-you-use-a-server">Should you use a server?</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#using-zookeeper">Using ZooKeeper</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#using-zookeeper-in-the-cloud">Using ZooKeeper in the Cloud</a></li>
<li class="toctree-l6"><a class="reference internal" href="#zookeeper-configuration-example">ZooKeeper Configuration Example</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#using-jgroups">Using JGroups</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#using-jgroups-in-the-cloud">Using JGroups in the Cloud</a></li>
<li class="toctree-l6"><a class="reference internal" href="#jgroups-configuration-example">JGroups Configuration Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="config-cache.html">Configuring and Monitoring the Cache</a></li>
<li class="toctree-l4"><a class="reference internal" href="config-messenger.html">Configuring and Monitoring the Messenger</a></li>
<li class="toctree-l4"><a class="reference internal" href="config-comm.html">Configuring and Monitoring the Comm Component</a></li>
<li class="toctree-l4"><a class="reference internal" href="config-server.html">Configuring, Running and Monitoring the Server</a></li>
<li class="toctree-l4"><a class="reference internal" href="config-misc.html">Miscellaneous Configurations</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

                    <hr/>
                    <ul>
                        <li><a href="http://puniverse.github.com/galaxy/javadoc/index.html">Javadocs</a></li>
                        <li><a href="https://github.com/puniverse/galaxy/downloads">Download</a></li>
                        <li><a href="https://groups.google.com/forum/#!forum/xxxx">Mailing List</a></li>
                        <li><a href="https://github.com/puniverse/galaxy/issues/">Issue Tracker</a></li>
                        <li><a href="http://blog.paralleluniverse.co">Blog</a></li>
                    </ul>
                </div>
                <div class="span9" id="body">
                     
  <div class="section" id="configuring-the-cluster-component">
<span id="man-config-cluster"></span><h1>Configuring the Cluster Component<a class="headerlink" href="#configuring-the-cluster-component" title="Permalink to this headline">¶</a></h1>
<p>The cluster component (defined by the Spring Bean named <tt class="docutils literal"><span class="pre">cluster</span></tt>) is the most fundamental of Galaxy&#8217;s components.
It defines how the Galaxy nodes discover each other and exchange configuration data.</p>
<p>There are currently two implementations of the cluster, one employing Apache ZooKeeper, and the other using JGroups. You may choose whichever you prefer. Note,
however, that ZooKeeper requires special server nodes while JGroups doesn&#8217;t.</p>
<div class="section" id="servers-and-backup-groups">
<span id="man-config-cluster-common"></span><h2>Servers and Backup Groups<a class="headerlink" href="#servers-and-backup-groups" title="Permalink to this headline">¶</a></h2>
<p>Both <tt class="docutils literal"><span class="pre">cluster</span></tt> implementations share a couple of properties.</p>
<p>The first sets the <tt class="docutils literal"><span class="pre">nodeId</span></tt> (constructor-arg, <tt class="docutils literal"><span class="pre">short</span></tt>). This is a required property.
The special node id of <tt class="docutils literal"><span class="pre">0</span></tt> is reserved for server nodes (see below).</p>
<p>The other common property is <tt class="docutils literal"><span class="pre">hasServer</span></tt> (property, <tt class="docutils literal"><span class="pre">boolean</span></tt>, default:<tt class="docutils literal"><span class="pre">true</span></tt>).
It is an optional property (with the default value <tt class="docutils literal"><span class="pre">true</span></tt>) that specifies whether the cluster has
server nodes.</p>
<p>There are two mechanisms by which Galaxy provides high-availability in the face of node failures: server nodes and backup groups.</p>
<div class="section" id="server-node">
<span id="man-config-cluster-organization-server"></span><h3>Server node<a class="headerlink" href="#server-node" title="Permalink to this headline">¶</a></h3>
<p>A server node (or nodes) is a special Galaxy node that doesn&#8217;t run application code, but is responsible for providing Galaxy data
with disk-based persistence. All of the data in the grid is persisted to disk on the server node, and is also automatically served
by it in case of a node failure.</p>
<p>The node server always has a node id of <tt class="docutils literal"><span class="pre">0</span></tt>, and, just like with regular nodes, you can have several server nodes in a
backup group (see below) configuration for added availability.</p>
<p>See <a class="reference internal" href="config-server.html#man-config-server"><em>Configuring, Running and Monitoring the Server</em></a> for more information about configuring and running server node(s).</p>
</div>
<div class="section" id="backup-groups">
<span id="man-config-cluster-organization-backup"></span><h3>Backup Groups<a class="headerlink" href="#backup-groups" title="Permalink to this headline">¶</a></h3>
<p>Galaxy nodes can be configured in backup groups. All nodes assigned the same node id in their configuration file will become part
of the same backup group. At any given time, each live backup group has exactly one <strong>master</strong> node, and zero or more <strong>slave</strong>
nodes. The master node replicates all of its owned data items to its slaves so that they can take over in case it fails.</p>
<p>When the master node fails, one of its slaves will become the master and take over. However, a master node <em>can never become a slave</em>.
A slave node is notified of its new master status by an event (see <a class="reference internal" href="../api/api-cluster.html#man-api-cluster-lifecycle"><em>Lifecycle events</em></a>).</p>
<p>See <a class="reference internal" href="../api/api-cluster.html#man-api-cluster-organization"><em>Cluster organization</em></a> for more information.</p>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p>This version of Galaxy does not yet support a backup group for the server. This feature will be ready by the time version
1.0 is finalized.</p>
<p class="last">This version of Galaxy supports backup groups of size 2 only (i.e. one master and one backup for each peer node).
Larger backup groups will not be supported in Galaxy version 1.0.</p>
</div>
</div>
<div class="section" id="should-you-use-a-server">
<span id="man-config-cluster-organization-serverless"></span><h3>Should you use a server?<a class="headerlink" href="#should-you-use-a-server" title="Permalink to this headline">¶</a></h3>
<p>Short answer: <strong>yes!</strong></p>
<p>While you can configure a Galaxy cluster without a server, such configuration entails a somewhat different cache-coherence protocol.
When not using a server node, if two node failures occur (from two different backup groups) within a very short time period,
this may result in lost data items (though not in data conflicts).</p>
<p>In addition, it is not yet clear how dependable the grid could be without a server, and how useful a server-less configuration is.
It is possible that the server-less configuration will be discontinued in a future version.</p>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">In this version, the server-less configuration is not dependable, and may result in lost data, and possibly data conflicts,
even if <em>a single node fails!</em></p>
</div>
</div>
</div>
<div class="section" id="using-zookeeper">
<span id="man-config-cluster-zookeeper"></span><h2>Using ZooKeeper<a class="headerlink" href="#using-zookeeper" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">cluster</span></tt> component can use <a class="reference external" href="http://zookeeper.apache.org/">Apache ZooKeeper</a> for cluster management. Galaxy uses ZooKeeper through the Netflix&#8217;s <a class="reference external" href="https://github.com/Netflix/curator">Curator</a> library
which simplifies ZooKeeper use. Please refer to the ZooKeeper documentation on how to set up ZooKeeper servers.</p>
<p>The ZooKeeper implementation of the <tt class="docutils literal"><span class="pre">cluster</span></tt> component is called <tt class="docutils literal"><span class="pre">co.paralleluniverse.galaxy.zookeeper.ZooKeeperCluster</span></tt>
and has (in addition to the common <tt class="docutils literal"><span class="pre">nodeId</span></tt> and <tt class="docutils literal"><span class="pre">hasServer</span></tt>) the following configuration properties:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">zkConnectString</span></tt> (constructor-arg, <tt class="docutils literal"><span class="pre">String</span></tt>)</dt>
<dd>The ZooKeeper connection string, which tells the node how to connect to the ZooKeeper servers. See the <a class="reference external" href="http://zookeeper.apache.org/doc/trunk/zookeeperProgrammers.html">ZooKeeper Programmers Guide</a> for details.</dd>
<dt><tt class="docutils literal"><span class="pre">sessionTimeoutMs</span></tt> (property, <tt class="docutils literal"><span class="pre">int</span></tt>, default: <tt class="docutils literal"><span class="pre">15000</span></tt>)</dt>
<dd>The ZooKeeper session timeout, in milliseconds. The ZooKeeper documentation has the details.</dd>
<dt><tt class="docutils literal"><span class="pre">connectionTimeoutMs</span></tt> (property, <tt class="docutils literal"><span class="pre">int</span></tt>, default: <tt class="docutils literal"><span class="pre">10000</span></tt>)</dt>
<dd>The Curator connection timeout, in milliseconds.</dd>
<dt><tt class="docutils literal"><span class="pre">retryPolicy</span></tt> (property, <tt class="docutils literal"><span class="pre">com.netflix.curator.retry.ExponentialBackoffRetry</span></tt>, default: <tt class="docutils literal"><span class="pre">new</span> <span class="pre">ExponentialBackoffRetry(20,</span> <span class="pre">20)</span></tt>)</dt>
<dd>The Curator retry policy for failed ZooKeeper operations. See the example below on how to set this property.
Refer to the <a class="reference external" href="https://github.com/Netflix/curator/wiki">Curator documentation</a> for details.</dd>
</dl>
<div class="section" id="using-zookeeper-in-the-cloud">
<h3>Using ZooKeeper in the Cloud<a class="headerlink" href="#using-zookeeper-in-the-cloud" title="Permalink to this headline">¶</a></h3>
<p>There generally shouldn&#8217;t be a problem running Galaxy with ZooKeeper in the cloud. However, using ZooKeeper requires that the
UDP implementation of the <tt class="docutils literal"><span class="pre">comm</span></tt> component be used, and that should be configured correctly to work in cloud environments.
Please refer to <a class="reference internal" href="config-comm.html#man-config-comm-common-cloud"><em>No multicast (using Galaxy in the cloud)</em></a> for information.</p>
</div>
<div class="section" id="zookeeper-configuration-example">
<h3>ZooKeeper Configuration Example<a class="headerlink" href="#zookeeper-configuration-example" title="Permalink to this headline">¶</a></h3>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;cluster&quot;</span> <span class="na">class=</span><span class="s">&quot;co.paralleluniverse.galaxy.zookeeper.ZooKeeperCluster&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;constructor-arg</span> <span class="na">name=</span><span class="s">&quot;nodeId&quot;</span> <span class="na">value=</span><span class="s">&quot;${grid.nodeId}&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;hasServer&quot;</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;constructor-arg</span> <span class="na">name=</span><span class="s">&quot;zkConnectString&quot;</span> <span class="na">value=</span><span class="s">&quot;127.0.0.1:2181&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;sessionTimeoutMs&quot;</span> <span class="na">value=</span><span class="s">&quot;1500&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;connectionTimeoutMs&quot;</span> <span class="na">value=</span><span class="s">&quot;1000&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;retryPolicy&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;com.netflix.curator.retry.ExponentialBackoffRetry&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">&quot;0&quot;</span> <span class="na">value=</span><span class="s">&quot;20&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;constructor-arg</span> <span class="na">index=</span><span class="s">&quot;1&quot;</span> <span class="na">value=</span><span class="s">&quot;20&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/bean&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="using-jgroups">
<span id="man-config-cluster-jgroups"></span><h2>Using JGroups<a class="headerlink" href="#using-jgroups" title="Permalink to this headline">¶</a></h2>
<p>Instead of ZooKeeper, the <tt class="docutils literal"><span class="pre">cluster</span></tt> component can used an implementation (called <tt class="docutils literal"><span class="pre">co.paralleluniverse.galaxy.jgroups.JGroupsCluster</span></tt>)
that employs <a class="reference external" href="http://www.jgroups.org/">JGroups</a> for cluster management. Unlike ZooKeeper, JGroups manages the cluster in a purely peer-to-peer fashion, and thus
does not require any special servers.</p>
<p>In addition to <tt class="docutils literal"><span class="pre">nodeId</span></tt> and <tt class="docutils literal"><span class="pre">hasServer</span></tt>, the JGroups <tt class="docutils literal"><span class="pre">cluster</span></tt> bean requires a few more properties, both must be identical in all
Galaxy nodes.</p>
<p>The first, <tt class="docutils literal"><span class="pre">jgroupsClusterName</span></tt> (constructor-arg, <tt class="docutils literal"><span class="pre">String</span></tt>), is a <tt class="docutils literal"><span class="pre">String</span></tt> identifier you choose to give the JGroups cluster.
This property must be identical in all of the cluster nodes.</p>
<p>The second is contains the detailed JGroups cluster configuration, and this property, too, must be identical in all nodes.</p>
<p>There are two options for setting it.
You can either set the <tt class="docutils literal"><span class="pre">jgroupsConfXML</span></tt> property to point to a JGroups XML configuration file,
or set the <tt class="docutils literal"><span class="pre">jgroupsConf</span></tt> property and embed within it the JGroups XML configuration, as in the example below.
You must set one of these properties, but not both.</p>
<p><a class="reference external" href="http://www.jgroups.org/manual-3.x/html/user-advanced.html#d0e2199">This section</a> of the JGroups manual explains the JGroups configuration in detail, but the JGroups jar file contains several complete
XML configuration files you can use as a basis.</p>
<p>Any valid JGroups configuration would do, but you must make two important addition to ensure proper operation of Galaxy (either in the embedded
configuration or in the separate XML file).</p>
<p>First, you must add the <a class="reference external" href="http://www.jgroups.org/manual-3.x/html/protlist.html#SEQUENCER">SEQUENCER</a>  protocol to the configuration,
so that a complete ordering of configuration messages is enforced. This is done by adding the following XML element to the JGroups configuration,
somewhere towards the bottom:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;SEQUENCER</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
<p>Second, you must add the <a class="reference external" href="http://www.jgroups.org/manual-3.x/html/protlist.html#COUNTER">COUNTER</a> protocol.
Add the following XML element at the very bottom of the JGroups configuration:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;COUNTER</span> <span class="na">bypass_bundling=</span><span class="s">&quot;true&quot;</span>  <span class="na">timeout=</span><span class="s">&quot;5000&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<p>Third, if the cluster is configured not to use a server (<tt class="docutils literal"><span class="pre">hasServer</span></tt> is set to <tt class="docutils literal"><span class="pre">false</span></tt>), a locking protocol must be added
to the bottom of JGroups configuration:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;CENTRAL_LOCK</span> <span class="na">num_backups=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">Do not forget to add the <tt class="docutils literal"><span class="pre">SEQUENCER</span></tt> and <tt class="docutils literal"><span class="pre">COUNTER</span></tt> (and if no server is used then <tt class="docutils literal"><span class="pre">CENTRAL_LOCK</span></tt> as well)
protocols to the JGroups configuration!</p>
</div>
<p>The third property, <tt class="docutils literal"><span class="pre">jgroupsThreadPool</span></tt> (property, <tt class="docutils literal"><span class="pre">java.util.concurrent.ThreadPoolExecutor</span></tt>, required), creates the thread pool used by
JGroups. Please refer to <a class="reference internal" href="config-misc.html#man-config-misc-threadpool"><em>Thread pools</em></a> to learn how to configure thread-pools, or look at the example below.</p>
<div class="section" id="using-jgroups-in-the-cloud">
<span id="man-config-cluster-jgroups-cloud"></span><h3>Using JGroups in the Cloud<a class="headerlink" href="#using-jgroups-in-the-cloud" title="Permalink to this headline">¶</a></h3>
<p>Some cloud environments (like Amazon EC2) prohibit multicast, so JGroups must be configured to not use multicast
if you&#8217;re running Galaxy in such an environment.</p>
<p>There are generally two options to use in such cases. The first is to use the <a class="reference external" href="http://www.jgroups.org/manual-3.x/html/protlist.html#UDP">UDP</a>
JGroups transport, but disable multicasting (by setting to <tt class="docutils literal"><span class="pre">false</span></tt> the <tt class="docutils literal"><span class="pre">ip_mcast</span></tt> property). In addition, you must use a discovery protocol
that does not employ multicasting, such as <tt class="docutils literal"><span class="pre">FILE_PING</span></tt>, <tt class="docutils literal"><span class="pre">JDBC_PING</span></tt>, <tt class="docutils literal"><span class="pre">RACKSPACE_PING</span></tt> or <tt class="docutils literal"><span class="pre">S3_PING</span></tt>.
See <a class="reference external" href="http://www.jgroups.org/manual-3.x/html/protlist.html#DiscoveryProtocols">Initial membership discovery</a> in the JGroups documentation
for more information on discovery protocols.</p>
<p>The other option is to use the <a class="reference external" href="http://www.jgroups.org/manual-3.x/html/protlist.html#TCP">TCP</a> JGroups transport with either the
<tt class="docutils literal"><span class="pre">TCPPING</span></tt> or <tt class="docutils literal"><span class="pre">TCPGOSSIP</span></tt> discovery protocols (or any of the ones mentioned above).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When using Galaxy and JGroups in environments that do not support multicasting, you must also configure the <tt class="docutils literal"><span class="pre">comm</span></tt> component appropriately.
See <a class="reference internal" href="config-comm.html#man-config-comm-common-cloud"><em>No multicast (using Galaxy in the cloud)</em></a>.</p>
</div>
</div>
<div class="section" id="jgroups-configuration-example">
<h3>JGroups Configuration Example<a class="headerlink" href="#jgroups-configuration-example" title="Permalink to this headline">¶</a></h3>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;cluster&quot;</span> <span class="na">class=</span><span class="s">&quot;co.paralleluniverse.galaxy.jgroups.JGroupsCluster&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;constructor-arg</span> <span class="na">name=</span><span class="s">&quot;nodeId&quot;</span> <span class="na">value=</span><span class="s">&quot;${grid.nodeId}&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;hasServer&quot;</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;constructor-arg</span> <span class="na">name=</span><span class="s">&quot;jgroupsClusterName&quot;</span> <span class="na">value=</span><span class="s">&quot;cluster1&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;jgroupsConf&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;value&gt;</span>
            <span class="cp">&lt;![CDATA[</span>
<span class="cp">            &lt;config xmlns=&quot;urn:org:jgroups&quot;</span>
<span class="cp">                    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
<span class="cp">                    xsi:schemaLocation=&quot;urn:org:jgroups http://www.jgroups.org/schema/JGroups-3.1.xsd&quot;&gt;</span>
<span class="cp">                &lt;UDP</span>
<span class="cp">                    mcast_port=&quot;${jgroups.udp.mcast_port:45588}&quot;</span>
<span class="cp">                    tos=&quot;8&quot;</span>
<span class="cp">                    ucast_recv_buf_size=&quot;20M&quot;</span>
<span class="cp">                    ucast_send_buf_size=&quot;640K&quot;</span>
<span class="cp">                    mcast_recv_buf_size=&quot;25M&quot;</span>
<span class="cp">                    mcast_send_buf_size=&quot;640K&quot;</span>
<span class="cp">                    loopback=&quot;true&quot;</span>
<span class="cp">                    discard_incompatible_packets=&quot;true&quot;</span>
<span class="cp">                    max_bundle_size=&quot;64K&quot;</span>
<span class="cp">                    max_bundle_timeout=&quot;30&quot;</span>
<span class="cp">                    ip_ttl=&quot;${jgroups.udp.ip_ttl:8}&quot;</span>
<span class="cp">                    enable_bundling=&quot;true&quot;</span>
<span class="cp">                    enable_diagnostics=&quot;true&quot;</span>
<span class="cp">                    thread_naming_pattern=&quot;cl&quot;</span>

<span class="cp">                    timer_type=&quot;new&quot;</span>
<span class="cp">                    timer.min_threads=&quot;4&quot;</span>
<span class="cp">                    timer.max_threads=&quot;10&quot;</span>
<span class="cp">                    timer.keep_alive_time=&quot;3000&quot;</span>
<span class="cp">                    timer.queue_max_size=&quot;500&quot;/&gt;</span>

<span class="cp">                &lt;PING timeout=&quot;2000&quot;</span>
<span class="cp">                      num_initial_members=&quot;4&quot;/&gt;</span>
<span class="cp">                &lt;MERGE3 max_interval=&quot;30000&quot;</span>
<span class="cp">                        min_interval=&quot;10000&quot;/&gt;</span>
<span class="cp">                &lt;FD_SOCK/&gt;</span>
<span class="cp">                &lt;FD_ALL/&gt;</span>
<span class="cp">                &lt;VERIFY_SUSPECT timeout=&quot;1500&quot;  /&gt;</span>
<span class="cp">                &lt;BARRIER /&gt;</span>
<span class="cp">                &lt;pbcast.NAKACK2 xmit_interval=&quot;1000&quot;</span>
<span class="cp">                                xmit_table_num_rows=&quot;100&quot;</span>
<span class="cp">                                xmit_table_msgs_per_row=&quot;2000&quot;</span>
<span class="cp">                                xmit_table_max_compaction_time=&quot;30000&quot;</span>
<span class="cp">                                max_msg_batch_size=&quot;500&quot;</span>
<span class="cp">                                use_mcast_xmit=&quot;false&quot;</span>
<span class="cp">                                discard_delivered_msgs=&quot;true&quot;/&gt;</span>
<span class="cp">                &lt;UNICAST /&gt;</span>
<span class="cp">                &lt;pbcast.STABLE stability_delay=&quot;1000&quot; desired_avg_gossip=&quot;50000&quot;</span>
<span class="cp">                               max_bytes=&quot;4M&quot;/&gt;</span>
<span class="cp">                &lt;pbcast.GMS print_local_addr=&quot;true&quot; join_timeout=&quot;3000&quot;</span>
<span class="cp">                            view_bundling=&quot;true&quot;/&gt;</span>
<span class="cp">                &lt;SEQUENCER /&gt;</span>
<span class="cp">                &lt;UFC max_credits=&quot;2M&quot;</span>
<span class="cp">                     min_threshold=&quot;0.4&quot;/&gt;</span>
<span class="cp">                &lt;MFC max_credits=&quot;2M&quot;</span>
<span class="cp">                     min_threshold=&quot;0.4&quot;/&gt;</span>
<span class="cp">                &lt;FRAG2 frag_size=&quot;60K&quot;  /&gt;</span>
<span class="cp">                &lt;pbcast.STATE_TRANSFER /&gt;</span>
<span class="cp">                &lt;COUNTER bypass_bundling=&quot;true&quot;</span>
<span class="cp">                         timeout=&quot;5000&quot;/&gt;</span>
<span class="cp">            &lt;/config&gt;</span>
<span class="cp">            ]]&gt;</span>
        <span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;jgroupsThreadPool&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;co.paralleluniverse.galaxy.core.ConfigurableThreadPool&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;constructor-arg</span> <span class="na">name=</span><span class="s">&quot;corePoolSize&quot;</span> <span class="na">value=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;constructor-arg</span> <span class="na">name=</span><span class="s">&quot;maxPoolSize&quot;</span> <span class="na">value=</span><span class="s">&quot;8&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;constructor-arg</span> <span class="na">name=</span><span class="s">&quot;keepAliveMillis&quot;</span> <span class="na">value=</span><span class="s">&quot;5000&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;constructor-arg</span> <span class="na">name=</span><span class="s">&quot;maxQueueSize&quot;</span> <span class="na">value=</span><span class="s">&quot;500&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/bean&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>


                </div>
            </div>
            <hr/>
            <footer>
                &copy; Copyright 2012, Parallel Universe Software Co..
                Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>
                1.1.3.
            </footer>
        </div>
    </body>
</html>


